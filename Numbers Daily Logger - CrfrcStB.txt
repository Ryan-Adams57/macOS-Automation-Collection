tell application "Numbers"
    activate
    try
        if not (exists document 1) then error number 1000
        tell document 1
            try
                tell active sheet
                    set the selectedTable to Â¬
                        (the first table whose class of selection range is range)
                end tell
            on error
                error number 1001
            end try
            tell selectedTable
                -- add a row to the end of the table
                add row below last row
                
                -- Begin date stuff
                set now to (current date)
                
                -- Set variables to the date's relevant properties.
                
                set {month:m, day:d, year:y} to now
                
                -- For the date, use the month number, the day, and the last two digits of the year.
                
                set dateString to y & "-" & (m as integer as text) & "-" & d
                -- End date stuff
                
                set the value of the last cell of column 1 to dateString as string
            end tell
        end tell
    on error errorMessage number errorNumber
        if errorNumber is 1000 then
            set alertString to "MISSING RESOURCE"
            set errorMessage to "Please create or open a document before running this script."
        else if errorNumber is 1001 then
            set alertString to "SELECTION ERROR"
            set errorMessage to "Please select a table before running this script."
        else
            set alertString to "EXECUTION ERROR"
        end if
        display alert alertString message errorMessage buttons {"Cancel"}
        error number -128
    end try
end tell