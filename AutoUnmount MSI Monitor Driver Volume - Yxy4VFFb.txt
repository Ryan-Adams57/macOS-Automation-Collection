-- Auto-Unmount MSI Monitor Driver Volume
-- Run whenever a volume is mounted

on volumeMounted(theVolume)
    -- Replace "MSI_DRIVE_NAME" with the exact name of the unwanted volume
    set targetVolumeName to "MSI_DRIVE_NAME"
    
    if name of theVolume is targetVolumeName then
        try
            -- Eject the volume immediately
            do shell script "diskutil unmount " & quoted form of (POSIX path of (theVolume as alias))
        on error errMsg
            display dialog "Failed to unmount volume: " & errMsg
        end try
    end if
end volumeMounted
